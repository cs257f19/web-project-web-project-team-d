<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <title>Kickstarter Tool: Comparison page</title>
    <link rel="stylesheet" type = "text/css" href ="{{ url_for('static', filename='chartstyle.css')}}" />
</head>
<body>



	<article>

    <h1>Kickstarter Comparison Tool</h1>
  <div class="topnav">
  <a class = "button" href="/home">Home</a>
  <a class = "button" href="/about">About</a>
  <a class="active" href="/comparison">Comparison</a>
  <div class="search-container">
    <form action="/action_page.php">
      <input type="text" placeholder="Search..." name="search">
      <button type="submit">Submit</button>
    </form>
  </div>
</div>


    <div class="row">
      <div class="tools"><h2>Data Comparison</h2>
      </div>
    </div>

	<div class="row">
  	<div class="col-3 menu">
    	<h3>Tool Menu</h3>
    	<ul>
				<li><a class= "button" href = "/comparison">Plot Tool</a></li>
      	<li class = "active" >Chart Tool</li>
    	</ul>
 		</div>

    <div class="col-9">
		<p>This page will generate a pie chart filtered by your parameters.
			Please select one display variable (the basis on which the data will be sorted and displayed),
			and enter any numerical parameters you wish to the input boxes as integers.
			  If you do not want to filter by a given paramter, such as Backer Count for example,
				leave both fields set to 0. All text fields must be filled, or a server error will occur.
				If after clicking submit there is no chart, your query had no hits in our database.</p>

  	</div>

    <div class="row">

		<form name = "results" method='POST'>


    	<div class="col-2">
			<h4>Backer Amount</h4>
				Min:
				<input type="text" name="backers_min" value = 0 />
				<br>
				Max:
				<input type="text" name="backers_max" value = 0 />




    	</div>
		<div class="col-2">
				<h4>Pledged Amount</h4>
					Min:
					<input type="text" name="pledged_min" value = 0 />
					<br>
					Max:
					<input type="text" name="pledged_max" value = 0 />


	  </div>

	  <div class="col-2">
			<h4>Goal Amount</h4>
				Min:
				<input type="text" name="goal_min" value = 0 />
				<br>
				Max:
				<input type="text" name="goal_max" value = 0 />
	  </div>


      <div class="col-2">
			<h4>Display Variable:</h4>
			<fieldset id="DisplayVariable">
				<input type="radio" name="DV" value="Spotlight"> Spotlight Status<br>
				<input type="radio" name="DV" value="Staffpick"> Staff-Pick Status<br>
				<input type="radio" name="DV" value="Status" checked> Project Status<br>

			</fieldset>
			<input type="submit" value="Submit">

	  </div>
	</form>





      <div class="row">
      	<div class="col-12">
		 <!--  <h4>x: {{field1}} vs y: {{field2}}</h4>  -->
		  <script src="https://cdn.anychart.com/js/8.0.1/anychart-core.min.js"></script>
		  <script src="https://cdn.anychart.com/js/8.0.1/anychart-pie.min.js"></script>
		  <script type ="text/javascript">

		  anychart.onDocumentReady(function() {

			// set the data
			console.log("{{newTable}}");

			var List1 = []
			var i = 1
			let theTable = "{{newTable}}"
			var noFat = theTable.replace(/&#34;/g,'');

			var noFat2 = noFat.replace(/\[/g,'');

			var noFat3 = noFat2.replace(/\]/g,'');

			var parsed1 = noFat3.split(', ');

			console.log(parsed1)
			var ParsedFixedList = []

			for (i = 0; i < parsed1.length; i = i + 2){
				ParsedFixedList.push([parsed1[i], parsed1[i+1]]);
			}
			console.log(ParsedFixedList)

			//let newtable = JSON.parse(newtable_json);
			//console.log(newtable);
			for (let rows of ParsedFixedList){
				List1.push({x: String(rows[0]), value: Number(rows[1])})
			}
			console.log(List1);

			var data = List1

			// create the chart
			var chart = anychart.pie();

			// set the chart title
			if ("{{params}}" == "All"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Backers from {{minBackers}} - {{maxBackers}}, Pledged from {{minPledged}} - {{maxPledged}}, Goal from {{minGoal}} - {{maxGoal}}");
			}
			else if ("{{params}}" == "B"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Backers from {{minBackers}} - {{maxBackers}}");
			}

			else if ("{{params}}" == "P"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Pledged from {{minPledged}} - {{maxPledged}}");
			}

			else if ("{{params}}" == "G"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Goal from {{minGoal}} - {{maxGoal}}");
			}

			else if ("{{params}}" == "BP"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Backers from {{minBackers}} - {{maxBackers}}, Pledged from {{minPledged}} - {{maxPledged}}");
			}

			else if ("{{params}}" == "BG"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Backers from {{minBackers}} - {{maxBackers}}, Goal from {{minGoal}} - {{maxGoal}}");
			}

			else if ("{{params}}" == "PG"){
				chart.title("Kickstarters Filtered By {{displayVariable}}, Pledged from {{minPledged}} - {{maxPledged}}, Goal from {{minGoal}} - {{maxGoal}}");
			}

			else if ("{{params}}" == "None"){
				chart.title("Kickstarters Filtered By {{displayVariable}}");
			}
			else{
				chart.title("ERROR_ERROR");
			}

			// add the data
			chart.data(data);

			// display the chart in the container
			chart.container('container');
			chart.draw();

			});
		  </script>

		  <div id="container" style="width: 100%; height: 200%;"></div>
		</div>


      	</div>
    	</div>

  	</div>

  </div>



		<section id="main_content">

			<p></p>
		</section>
	</article>
</body>


</html>
